<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>FHIR Forms</title>
  </head>
  <body>
    <div class="container">
      <h1 class="mt-5">FHIR Forms</h1>
      <p>This application allows you to test your FHIR Questionnaires like Google Forms. You can enter the URL of the form and the endpoint URL where the Questionnaire resource will be sent. You can also view the results of the submitted forms.</p>
      <form id="urlForm" class="mt-3">
        <div class="form-group">
          <label for="formURL">Form URL</label>
          <input type="url" class="form-control" id="formURL" placeholder="Enter form URL" value="https://hapi.fhir.org/baseR4/Questionnaire/11440959">
          <label for="endpointURL">Endpoint URL</label>
          <input type="url" class="form-control" id="endpointURL" placeholder="Enter endpoint URL" value="https://hapi.fhir.org/baseR4/QuestionnaireResponse">        
        </div>
        <button type="submit" class="btn btn-primary">Go to Form</button>
        <button type="button" id="viewResultsBtn" class="btn btn-secondary ml-2">View Results</button>
      </form>
    </div>

    <script>
  document.getElementById('urlForm').addEventListener('submit', function(event) {
    event.preventDefault();
    const formURL = document.getElementById('formURL').value;
    const endpointURL = document.getElementById('endpointURL').value; // get the endpoint URL
    window.location.href = `/form?form_url=${encodeURIComponent(formURL)}&endpoint_url=${encodeURIComponent(endpointURL)}`; // include it in the URL
  });


      document.getElementById('viewResultsBtn').addEventListener('click', function() {
        const formURL = document.getElementById('formURL').value;
        const endpointURL = document.getElementById('endpointURL').value; // get the endpoint URL
        window.location.href = `/results?form_url=${encodeURIComponent(formURL)}&endpoint_url=${encodeURIComponent(endpointURL)}`; // include it in the URL
      });
    </script>
  </body>
</html>
